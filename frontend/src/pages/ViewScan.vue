<template>
  <v-card class="my-4 mx-auto" max-width="1200">
    <v-container class="container-map">
      <l-map class="map" :zoom="zoom" :center="center">
        <l-tile-layer :url="url"></l-tile-layer>
        <l-marker :lat-lng="markerLatLng"></l-marker>
      </l-map>
    </v-container>
    <v-container class="container-tables">
      <v-card-title>
        <v-icon>public</v-icon>
        <small class="title-domain">{{ domain }}</small>
      </v-card-title>
      <v-card-text>
        <v-card class="my-2" v-for="(item, i) in scan" :key="i">
          <v-card-title>{{ item.bot }}</v-card-title>
          <v-card-text class="text-subcard">
            <div v-if="item.bot === 'geo'">
              <div v-for="(element, index) in item.results" :key="index">
                <div v-for="(e, i) in element" :key="i">
                  <span class="subtitle-2">{{ i }}:&emsp;</span>
                  <span>{{ e }}</span>
                </div>
              </div>
            </div>
            <div v-if="item.bot === 'nobita'">
              <div v-for="(element, index) in item.results" :key="index">
                <div v-for="(e, i) in element" :key="i">
                  <div>
                    <span class="subtitle-2">{{ i }}:</span>
                    <span>{{ e }}</span>
                  </div>
                </div>
              </div>
            </div>
            <div v-if="item.bot === 'shizuka'">
              <div v-for="(element, index) in item.results" :key="index">
                <span class="body-2">{{ element }}</span>
              </div>
            </div>
            <div v-if="item.bot === 'suneo'">
              <div v-for="(element, index) in item.results" :key="index">
                <div v-for="(e, i) in element" :key="i">
                  <div>
                    <span class="subtitle-2">{{ i }}:</span>
                    <span>{{ e }}</span>
                  </div>
                </div>
              </div>
            </div>
          </v-card-text>
        </v-card>
      </v-card-text>
    </v-container>
  </v-card>
</template>

<script>
import { LMap, LTileLayer, LMarker } from "vue2-leaflet";
import { mapGetters } from "vuex";
import { ONE_SCAN_INFO } from "../store/actions.type";

export default {
  components: {
    LMap,
    LTileLayer,
    LMarker
  },
  data: () => ({
    url: "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
    zoom: 8,
    center: [40.4168, -3.70379],
    markerLatLng: [40.4168, -3.70379],
    domain: String,
    ip: String,
    nobita: [],
    shizuka: [],
    suneo: {},
    gigante: {},
    geo: {},
    listNobita: [],
    aux: []
  }),

  created() {
    let id_scan = this.$route.params.id_scan.toString();
    this.domain = this.$route.params.ip.toString();
    let num = this.$route.params.index.toString();
    let params = {
      id_scan: id_scan,
      domain: this.domain,
      num: num
    };
    this.$store.dispatch(`scans/${ONE_SCAN_INFO}`, params);
  },

  computed: {
    ...mapGetters({ scan: "scans/oneScan" })
  },

  methods: {
    initialize() {},

    loadLocation(lat, lon) {
      if (lat !== undefined || lon !== undefined) {
        this.center = [lat, lon];
        this.markerLatLng = [lat, lon];
      }
    }
  }
};
</script>

<style>
.container-map {
  height: 300px;
  width: 100%;
}

.map {
  height: 100%;
  width: 100%;
}

.title-ip {
  color: rgba(0, 0, 0, 0.54);
}

.title-domain {
  font-size: 18px;
  padding-left: 10px;
  font-weight: 400;
  color: #999;
}

.text-subcard {
  text-align: left;
}

.suneo-tech {
  padding: 16px 0px;
}

.suneo-tech-item {
  font-family: "Roboto", sans-serif;
  padding: 0px 16px;
}
</style>
